{% extends "base.html" %}

{% block title %}Buscador - {{ app_nombre }}{% endblock %}

{% block content %}
<h1 class="mb-4">Resultados de búsqueda</h1>

<form method="get" action="{{ url_for('buscar') }}" class="row g-3 mb-4">
    <div class="col-md-4">
        <label for="texto" class="form-label">Texto libre</label>
        <input type="text" class="form-control" id="texto" name="texto" value="{{ texto }}">
    </div>
    <div class="col-md-3">
        <label for="autor" class="form-label">Autor</label>
        <input type="text" class="form-control" id="autor" name="autor" value="{{ autor }}">
    </div>
    <div class="col-md-2">
        <label for="anio_desde" class="form-label">Año desde</label>
        <input type="number" class="form-control" id="anio_desde" name="anio_desde" value="{{ anio_desde }}">
    </div>
    <div class="col-md-2">
        <label for="anio_hasta" class="form-label">Año hasta</label>
        <input type="number" class="form-control" id="anio_hasta" name="anio_hasta" value="{{ anio_hasta }}">
    </div>
    <div class="col-md-1 d-flex align-items-end">
        <button type="submit" class="btn btn-primary w-100">Buscar</button>
    </div>
</form>

<p><strong>Total de resultados:</strong> {{ total_resultados }}</p>

{% if error %}
    <div class="alert alert-danger">Error: {{ error }}</div>
{% endif %}

{% if resultados %}
    <div class="list-group">
        {% for libro in resultados %}
            <div class="list-group-item bg-dark text-light border-secondary mb-2">
                <h2 class="h5 mb-1">
                    {{ libro.titulo or libro.title or "Sin título" }}
                </h2>
                <p class="mb-1">
                    <strong>Autor:</strong> {{ libro.autor or "Desconocido" }}
                    {% if libro.anio %}
                        · <strong>Año:</strong> {{ libro.anio }}
                    {% endif %}
                </p>
                {% if libro.descripcion %}
                    <p class="mb-0">{{ libro.descripcion }}</p>
                {% elif libro.resumen %}
                    <p class="mb-0">{{ libro.resumen }}</p>
                {% endif %}
            </div>
        {% endfor %}
    </div>
{% else %}
    <p>No se encontraron libros con esos filtros.</p>
{% endif %}
{% endblock %}
