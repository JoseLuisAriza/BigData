{% extends "base.html" %}

{% block content %}
<h1 class="mb-4">Resultados de búsqueda</h1>

<form class="row g-3 mb-4" method="get" action="{{ url_for('buscar') }}">
    <div class="col-md-4">
        <label class="form-label">Texto libre</label>
        <input type="text" class="form-control" name="texto" value="{{ texto }}">
    </div>
    <div class="col-md-4">
        <label class="form-label">Autor</label>
        <input type="text" class="form-control" name="autor" value="{{ autor }}">
    </div>
    <div class="col-md-2">
        <label class="form-label">Año desde</label>
        <input type="number" class="form-control" name="anio_desde" value="{{ anio_desde }}">
    </div>
    <div class="col-md-2">
        <label class="form-label">Año hasta</label>
        <input type="number" class="form-control" name="anio_hasta" value="{{ anio_hasta }}">
    </div>
    <div class="col-12 d-flex gap-2">
        <button type="submit" class="btn btn-primary">Buscar de nuevo</button>
        <!-- Aquí también evitamos url_for('index') -->
        <a href="/" class="btn btn-outline-light">Volver al inicio</a>
    </div>
</form>

{% if total is not none %}
    <p><strong>Total de resultados:</strong> {{ total }}</p>

    <div class="list-group">
        {% for libro in libros %}
            <div class="list-group-item bg-dark border-secondary text-light mb-2">
                <h5 class="mb-1">{{ libro.titulo or "Título desconocido" }}</h5>
                <p class="mb-1">
                    <strong>Autor:</strong> {{ libro.autor or "Desconocido" }}
                    &nbsp;|&nbsp;
                    <strong>Año:</strong> {{ libro.anio or "N/D" }}
                </p>
            </div>
        {% else %}
            <p>No se encontraron libros con esos filtros.</p>
        {% endfor %}
    </div>
{% endif %}
{% endblock %}
